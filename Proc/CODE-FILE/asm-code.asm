; System start alloc memory
PUSH 0
POPR AX
PUSH 100
POPR BX
; Start main code
PUSH 0
PUSHR BX
PUSH 0
ADD
POPR FX
POPM FX

IN
PUSHR BX
PUSH 0
ADD
POPR FX
POPM FX

PUSHR BX
PUSH 0
ADD
POPR FX
PUSHM FX

PUSHM AX
PUSHR BX
ADD
POPR BX
PUSHR AX
PUSH 1
ADD
POPR AX
PUSH 1
POPM AX

CALL :fact
PUSHR CX
OUT

HLT

; Start All Functions
:fact
PUSHR BX
PUSH 0
ADD
POPR FX
POPM FX

PUSHR BX
PUSH 0
ADD
POPR FX
PUSHM FX

OUT

PUSH 1
PUSHR BX
PUSH 0
ADD
POPR FX
PUSHM FX

JA $3
PUSH 0
JMP $1
PUSH 1

PUSH 0
JE :cond2
PUSH 100
OUT

PUSH 1
PUSHR BX
PUSH 0
ADD
POPR FX
PUSHM FX

SUB
PUSHM AX
PUSHR BX
ADD
POPR BX
PUSHR AX
PUSH 1
ADD
POPR AX
PUSH 1
POPM AX

CALL :fact
PUSHR CX
PUSHR BX
PUSH 0
ADD
POPR FX
PUSHM FX

MUL
PUSHR BX
PUSH 0
ADD
POPR FX
POPM FX

JMP :cond1
:cond2
PUSH 50
OUT

PUSH 1
POPR CX
PUSHM AX
PUSHR BX
SUB
POPM BX
PUSH 1
PUSHR AX
SUB
POPR AX

RET
PUSH 300
OUT

:cond1
PUSHR BX
PUSH 0
ADD
POPR FX
PUSHM FX

OUT

PUSHR BX
PUSH 0
ADD
POPR FX
PUSHM FX

POPR CX
PUSHM AX
PUSHR BX
SUB
POPM BX
PUSH 1
PUSHR AX
SUB
POPR AX

RET
HLT
